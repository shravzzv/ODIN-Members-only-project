extends layout

block content
  h1 Create new message

  //- make it work with only server side validation first
  - const titleError = errors && errors.find(item => item.path === 'title')
  - const messageError = errors && errors.find(item => item.path === 'message')
  - const fileError = errors && errors.find(item => item.path === 'file')

  form(action="", method="post", enctype = "multipart/form-data")
    .formControl
      label(for="title") Title*:
      input#title(type="text", name="title", placeholder="Express Validation.", value!=message ? message.title : '')
      if titleError
        span.error= titleError.msg

    .formControl
      label(for="message") Message*:
      textarea#message(name="message", cols="30", rows="10", placeholder="Express validation allows users to...")!=message ? message.message : ''
      if messageError
        span.error= messageError.msg

    - const isCoverImgPresent = message && message.coverImgUrl.includes("cloudinary")
    if isCoverImgPresent
      img(src=message.coverImgUrl, alt=message.title)
      input(type="hidden", name="imgUrl", value=message.coverImgUrl)
    .formControl
      label(for="file")= isCoverImgPresent ? 'Update cover image:' : 'Cover image:'
      input#file(type="file", name="file")
      if fileError
        span.error= fileError.msg

    .formControl
      label(for="tags") Tags:
      input#tags(type="text", name="tags", placeholder="nodejs, express, ...", value!=message ? message.tags.join(", ") : '')
      //- todo: make it work like GitHub tags

    button(type="submit") Submit